import { isScalar } from '../nodes/identity.js';

function mapIncludes(ctx, items, search) {
    const { uniqueKeys } = ctx.options;
    if (uniqueKeys === false)
        return false;
    const isEqual = typeof uniqueKeys === 'function'
        ? uniqueKeys
<<<<<<< HEAD
        : (a, b) => a === b || (isScalar(a) && isScalar(b) && a.value === b.value);
=======
        : (a, b) => a === b ||
            (isScalar(a) &&
                isScalar(b) &&
                a.value === b.value &&
                !(a.value === '<<' && ctx.schema.merge));
>>>>>>> 981e02d8b3161fb3284b6e7416793ef8f82f8915
    return items.some(pair => isEqual(pair.key, search));
}

export { mapIncludes };
